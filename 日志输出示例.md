# 日志输出示例

## 示例1: 访问用户列表页

```
================================================================================
【请求信息】
请求方法: GET
请求URL: http://127.0.0.1:8000/users
请求路由: users.index
处理器: UsersController@index
完整类名: App\Http\Controllers\UsersController
客户端IP: 127.0.0.1
请求参数: 无

【SQL查询】 共执行 2 条SQL
SQL #1 (耗时: 1.23ms):
SELECT count(*) as aggregate FROM `users`

SQL #2 (耗时: 2.45ms):
SELECT * FROM `users` LIMIT 10 OFFSET 0

请求耗时: 45.67ms
--------------------------------------------------------------------------------
```

## 示例2: 用户注册

```
================================================================================
【请求信息】
请求方法: POST
请求URL: http://127.0.0.1:8000/users
请求路由: users.store
处理器: UsersController@store
完整类名: App\Http\Controllers\UsersController
客户端IP: 127.0.0.1
请求参数: {
    "name": "张三",
    "email": "zhangsan@example.com",
    "password": "***已过滤***",
    "password_confirmation": "***已过滤***",
    "_token": "***已过滤***"
}

【SQL查询】 共执行 3 条SQL
SQL #1 (耗时: 1.12ms):
SELECT * FROM `users` WHERE `email` = 'zhangsan@example.com' LIMIT 1

SQL #2 (耗时: 3.56ms):
INSERT INTO `users` (`name`, `email`, `password`, `activation_token`, `created_at`, `updated_at`) 
VALUES ('张三', 'zhangsan@example.com', '$2y$10$abcd...', 'abc123token', '2025-11-06 12:00:00', '2025-11-06 12:00:00')

SQL #3 (耗时: 0.89ms):
SELECT * FROM `users` WHERE `id` = 1 LIMIT 1

请求耗时: 78.34ms
--------------------------------------------------------------------------------
```

## 示例3: 更新用户信息

```
================================================================================
【请求信息】
请求方法: PUT
请求URL: http://127.0.0.1:8000/users/1
请求路由: users.update
处理器: UsersController@update
完整类名: App\Http\Controllers\UsersController
客户端IP: 127.0.0.1
请求参数: {
    "name": "张三（已修改）",
    "password": "***已过滤***",
    "password_confirmation": "***已过滤***",
    "_method": "PUT",
    "_token": "***已过滤***"
}

【SQL查询】 共执行 2 条SQL
SQL #1 (耗时: 1.05ms):
SELECT * FROM `users` WHERE `id` = 1 LIMIT 1

SQL #2 (耗时: 2.34ms):
UPDATE `users` SET `name` = '张三（已修改）', `password` = '$2y$10$xyz...', `updated_at` = '2025-11-06 12:05:00' 
WHERE `id` = 1

请求耗时: 34.56ms
--------------------------------------------------------------------------------
```

## 示例4: 删除用户

```
================================================================================
【请求信息】
请求方法: DELETE
请求URL: http://127.0.0.1:8000/users/2
请求路由: users.destroy
处理器: UsersController@destroy
完整类名: App\Http\Controllers\UsersController
客户端IP: 127.0.0.1
请求参数: {
    "_method": "DELETE",
    "_token": "***已过滤***"
}

【SQL查询】 共执行 3 条SQL
SQL #1 (耗时: 0.98ms):
SELECT * FROM `users` WHERE `id` = 1 LIMIT 1

SQL #2 (耗时: 1.23ms):
SELECT * FROM `users` WHERE `id` = 2 LIMIT 1

SQL #3 (耗时: 2.67ms):
DELETE FROM `users` WHERE `id` = 2

请求耗时: 28.45ms
--------------------------------------------------------------------------------
```

## 示例5: 用户登录

```
================================================================================
【请求信息】
请求方法: POST
请求URL: http://127.0.0.1:8000/login
请求路由: login
处理器: SessionsController@store
完整类名: App\Http\Controllers\SessionsController
客户端IP: 127.0.0.1
请求参数: {
    "email": "zhangsan@example.com",
    "password": "***已过滤***",
    "_token": "***已过滤***"
}

【SQL查询】 共执行 2 条SQL
SQL #1 (耗时: 1.45ms):
SELECT * FROM `users` WHERE `email` = 'zhangsan@example.com' LIMIT 1

SQL #2 (耗时: 0.87ms):
UPDATE `users` SET `remember_token` = 'abc123xyz', `updated_at` = '2025-11-06 12:10:00' WHERE `id` = 1

请求耗时: 42.12ms
--------------------------------------------------------------------------------
```

## 示例6: 查看用户详情

```
================================================================================
【请求信息】
请求方法: GET
请求URL: http://127.0.0.1:8000/users/1
请求路由: users.show
处理器: UsersController@show
完整类名: App\Http\Controllers\UsersController
客户端IP: 127.0.0.1
请求参数: 无

【SQL查询】 共执行 1 条SQL
SQL #1 (耗时: 1.12ms):
SELECT * FROM `users` WHERE `id` = 1 LIMIT 1

请求耗时: 23.45ms
--------------------------------------------------------------------------------
```

## 示例7: 静态页面（闭包路由）

```
================================================================================
【请求信息】
请求方法: GET
请求URL: http://127.0.0.1:8000/
请求路由: home
处理器: StaticPagesController@home
完整类名: App\Http\Controllers\StaticPagesController
客户端IP: 127.0.0.1
请求参数: 无

【SQL查询】 无

请求耗时: 15.67ms
--------------------------------------------------------------------------------
```

## 示例8: 慢查询警告

```
================================================================================
【请求信息】
请求方法: GET
请求URL: http://127.0.0.1:8000/reports/complex
请求路由: reports.complex
处理器: ReportsController@complex
完整类名: App\Http\Controllers\ReportsController
客户端IP: 127.0.0.1
请求参数: 无

【SQL查询】 共执行 1 条SQL
SQL #1 (耗时: 1234.56ms):
SELECT u.*, COUNT(a.id) as article_count, AVG(a.views) as avg_views 
FROM `users` u 
LEFT JOIN `articles` a ON u.id = a.user_id 
WHERE u.status = 'active' 
GROUP BY u.id 
HAVING article_count > 10 
ORDER BY avg_views DESC

⚠️  慢查询警告：此查询耗时超过1秒！

请求耗时: 1256.78ms
--------------------------------------------------------------------------------
```

## 关键信息说明

### 控制器信息
- **处理器**: 简短格式，方便快速查看（例如：UsersController@index）
- **完整类名**: 完整的命名空间路径（例如：App\Http\Controllers\UsersController）

### 敏感信息过滤
所有包含以下关键词的字段都会被自动过滤：
- password
- password_confirmation
- token
- secret
- api_key

### SQL 类型识别
日志可以记录所有类型的SQL操作：
- **SELECT**: 查询操作
- **INSERT**: 插入操作
- **UPDATE**: 更新操作
- **DELETE**: 删除操作
- **其他**: CREATE、ALTER、DROP 等DDL操作

### 性能监控
- **单条SQL耗时**: 每条SQL都会显示执行时间
- **慢查询警告**: 超过1秒的查询会有警告标记
- **请求总耗时**: 整个请求从开始到结束的时间


